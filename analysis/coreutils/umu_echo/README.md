# umu_echo（echo の解析・最小実装）

このディレクトリは、GNU coreutils の `echo` を題材にして
「ユーザーランドのコマンドは最低限どこまで削れるか」「どの機能が“本質”でどの機能が“周辺”か」を
整理するための解析メモ／実験場です。

## これは何の解析か

- 対象: `echo(1)` 相当コマンド
- 観点:
  - 文字列を標準出力へ出す、という本質の最小核
  - 互換性・歴史的経緯（POSIX / System V / bash 由来の挙動など）により増えた周辺機能
  - i18n、ヘルプ・バージョン表示、環境変数による分岐など「汎用化のための層」

本ディレクトリの `src/umu_echo.c` は、上記の“本質”だけ残した最小版です。

## どこから来たコードか

出発点の参考実装は、GNU coreutils 9.4 系の `src/echo.c`（bash 由来の実装を取り込んだもの）です。
本リポジトリには参照用として coreutils のツリーが `external/coreutils-9.4-userland/` に置かれています。

ただし現在の `src/umu_echo.c` は、依存（`config.h` / gnulib / i18n 等）を排除し、
学習用に“最小限動く”ことを優先して書き直したものです。

## どう読むべきか（おすすめの読み順）

1. まず `man/umu_echo.1` を読み、仕様（実装している範囲）を確定させる
2. `src/umu_echo.c` を読み、
	- 引数列の連結
	- `-n` による改行抑制
	だけでコマンドの核が成立することを確認する
3. 参照として `external/coreutils-9.4-userland/src/echo.c` を眺め、
	- 互換性のための分岐
	- エスケープ解釈
	- `--help/--version` やロケール対応
	などの“汎用化の層”がどこで入るかを追う
4. 最後に `NOTES.roff` を読み、設計判断・削除した機能・差分の思想を把握する

## ビルド例（単体で確認）

このディレクトリ単体で動作確認する場合は、例えば以下で十分です。

```sh
cc -Wall -Wextra -O2 -o umu_echo src/umu_echo.c
./umu_echo hello world
./umu_echo -n hello
```
