# ver0.1.1 次回用チェックリスト（理解・再現性優先）

目的：次のPJ（UmuOS-0.1.1 のやり直し等）で、
「混ざって壊れる」「どこまで進んだか分からない」を防ぐ。

---

## 0. 事前ルール（最重要）

- 1回の実験で変えるのは1点だけ
- 次に進む前に“観測（ログ/表示）”で到達点を確定する
- ext4 が怪しいなら、続行前に fsck を挟む（原因の混入を断つ）
- 手順通りに進め、チェックしながら進める。不具合がでた時点で、都度解決する

---

## 1. 実験前チェック

- 何を変える？（1行で言える）
- 期待する観測点は？（3行以内）
- 失敗したら何で戻す？（手順が文章で言える）

---

## 2. ブート経路（ネット無し）

- UEFI → GRUB → kernel が起動している
- initramfs で以下が観測できる
  - devtmpfs が有効（/dev にデバイスが出る）
  - `root=UUID=...` が読めている
  - UUID一致デバイスが見つかる
  - `/newroot` に ext4 が mount できる
  - `switch_root` を実行した

失敗したら：
- まず「どの観測点まで出たか」を記録してから戻る

---

## 3. ext4 ルート側（ログインまで）

- `/sbin/init` が動いている（BusyBox init でも良い）
- `getty/login` が出る
- root/tama がパスワードでログインできる

ログイン失敗の基本切り分け：
- `/etc/passwd` の存在と形式
- `/etc/shadow` の存在、権限 600、ハッシュがプレースホルダでない

---

## 4. ext4 健全性（原因混入の遮断）

- VM停止後に `sudo e2fsck -f disk.img` を実行
- エラーが出た場合は修復してから再開

---

## 5. ネットワークは最後（必要なときだけ）

- シリアルでログインが確定してから導入する
- Proxmox/ブリッジに影響が出る場合は、まずNATで代替し影響範囲を閉じる
- 次期ver0.1.1では、ネットワークは、考えない（シリアル起動でOK）

