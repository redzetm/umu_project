---
title: UmuOS0.1.2との違い（0.1.3）
date: 2026-01-18
---

# UmuOS 0.1.3 は 0.1.2 から何が変わったか（差分・総括）

この文書は、UmuOS-0.1.2 と UmuOS-0.1.3 の差分を「何を追加し、何を捨て、何を次に回したか」で整理する。

参照：

- 0.1.2: `~/umu/umu_project/UmuOS-0.1.2/docs/`
- 0.1.3: `~/umu/umu_project/UmuOS-0.1.3/docs/`

---

## 1. 結論（0.1.3 の差分は 1点に絞る）

0.1.3 の主差分は **同時ログインの成立**。

- ttyS0（主コンソール）に加え、ttyS1（追加コンソール）でもログインできる
- root と tama を **同時に** ログインして操作できる

この差分を確実にするため、0.1.3 では `su` とログ基盤の整備を見送る。

---

## 2. 変えていないもの（0.1.2 と共通）

- ブートフロー：UEFI → GRUB → kernel → initramfs（自作 `/init`）→ ext4（disk.img）へ `switch_root`
- Kernel version：`6.18.1`（差分最小化）
- 永続ディスク：ext4 の `disk.img` を root にする（UUID 指定）

---

## 3. 主要差分（一覧）

| 観点 | 0.1.2 | 0.1.3 |
|---|---|---|
| 同時ログイン | ttyS0 のみ | ttyS0 + ttyS1（両方に `getty` を立てる） |
| ttyS1 の提供方式 | 該当なし | **QEMU のTCPシリアル公開**（`-serial tcp:127.0.0.1:PORT,server,nowait`） |
| 接続手段 | 該当なし | ホストから `telnet 127.0.0.1 PORT`（必要に応じて `nc` も可） |
| `su` | 仕様外（または不安定） | **0.1.3では見送り**（0.1.4以降で別設計） |
| ログ整備 | 0.1.2の範囲 | **0.1.3では見送り**（0.1.4以降） |

---

## 4. 設計判断（なぜこうするか）

### 4.1 `su` を見送る理由

`su` は「SUID」「BusyBoxの実装」「rootfs の mount オプション（nosuid）」「NoNewPrivs」など、同時ログインと無関係な罠が多い。
0.1.3 の主目的（同時ログイン）を確実にするため、スコープ外へ分離する。

### 4.2 ttyS1 を TCP にする理由

PTY（`-serial pty`）は環境や接続手段により排他で開けないケースがあり、再現性が落ちる。
TCPで公開する方式は「ホストから 127.0.0.1 に接続するだけ」になり、接続の安定度が上がる。

---

## 5. まとめ（0.1.3 を固定してよい理由）

0.1.3 は「同時ログイン」を確実に成立させる最小拡張。
その結果、以後の実験では root と一般ユーザーの作業を並行でき、開発効率が上がる。
