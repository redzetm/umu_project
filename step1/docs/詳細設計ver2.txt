
- 目的に直結 →          「最小限のカーネル＋BusyBox initramfsでQEMU起動確認」になっている
- 構成がシンプル →       BusyBox採用で systemd 問題を回避
- 成果物が明示 →         bzImage, initrd.img, grub.cfg, ISO が揃う
- 成功条件が明確 →       GRUB表示 → カーネル起動 → シェル操作



# 1. 環境準備

### 1.1 必要パッケージのインストール

bash

sudo apt update
sudo apt install -y build-essential bc bison flex libssl-dev \
  libelf-dev libncurses-dev dwarves git wget \
  grub-efi-amd64-bin grub-common xorriso mtools \
  qemu-system-x86 ovmf \
  cpio gzip busybox-static


### 1.2 ディレクトリ作成

bash
mkdir -p ~/umu/step1/{kernel,initramfs,iso_root/boot/grub,logs}


## 2. カーネルビルド

### 2.1 ソース取得

bash
cd ~/umu/step1/kernel
wget https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-6.6.58.tar.xz
tar -xf linux-6.6.58.tar.xz
cd linux-6.6.58

### 2.2 カーネル設定

bash
make mrproper           #カーネルソースツリーを完全にクリーンな状態にする
make defconfig          #コンフィグレーション生成

# 必要なら make menuconfig でカスタマイズ（今回はデフォルトで行きます）

cp .config ../config-6.6.58


### 2.3 ビルド

bash
make -j$(nproc)

# カーネルモジュールもビルド（今回はこの工程は無しとする）
make modules -j$(nproc)

### 2.4 成果物コピー

bash
cp arch/x86/boot/bzImage ~/umu/step1/iso_root/boot/vmlinuz-6.6.58
cp .config ~/umu/step1/iso_root/boot/config-6.6.58
















































































